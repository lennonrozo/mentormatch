# Deployment Guide

This guide walks you through deploying MentorMatch with:
- **Frontend**: GitHub Pages (free, static hosting)
- **Backend**: Render (free tier, includes PostgreSQL database)

## Prerequisites

- GitHub account
- Render account (sign up at https://render.com - free)
- Git installed locally

---

## Part 1: Deploy Backend to Render

### Step 1: Push Code to GitHub

1. Create a new repository on GitHub (e.g., `mentormatch`)

2. Initialize and push your code:
```bash
cd /Users/lennonrozo/Desktop/mentormatch
git init
git add .
git commit -m "Initial commit - MentorMatch app"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/mentormatch.git
git push -u origin main
```

### Step 2: Create Render Service

1. Go to https://dashboard.render.com/
2. Click **"New +"** → **"Blueprint"**
3. Connect your GitHub repository
4. Render will automatically detect `render.yaml` and set up:
   - A web service for the Django backend
   - A PostgreSQL database

### Step 3: Configure Environment Variables

In your Render dashboard, go to your web service and add these environment variables:

```
SECRET_KEY=(auto-generated by Render, already set)
DEBUG=False
ALLOWED_HOSTS=your-app-name.onrender.com
CORS_ALLOWED_ORIGINS=https://YOUR_USERNAME.github.io
```

Replace:
- `your-app-name` with your actual Render service name
- `YOUR_USERNAME` with your GitHub username

### Step 4: Get Your Backend URL

Once deployed, your backend will be at:
```
https://your-app-name.onrender.com
```

**Important**: Copy this URL - you'll need it for the frontend!

⚠️ **Note**: Free tier services spin down after 15 minutes of inactivity. First request after idle may take 30-60 seconds.

---

## Part 2: Deploy Frontend to GitHub Pages

### Step 1: Update Vite Config

Edit `mentormatch_frontend/vite.config.js`:

```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  base: '/mentormatch/',  // ⚠️ Change to YOUR repo name
  build: {
    outDir: 'dist',
  },
})
```

### Step 2: Add GitHub Secret for API URL

1. Go to your GitHub repository
2. Click **Settings** → **Secrets and variables** → **Actions**
3. Click **"New repository secret"**
4. Name: `VITE_API_BASE_URL`
5. Value: `https://your-app-name.onrender.com` (your Render backend URL)
6. Click **"Add secret"**

### Step 3: Enable GitHub Pages

1. In your GitHub repo, go to **Settings** → **Pages**
2. Under **Source**, select **GitHub Actions**
3. Save

### Step 4: Trigger Deployment

Push your changes to trigger the deployment:

```bash
git add .
git commit -m "Configure for production deployment"
git push
```

GitHub Actions will automatically:
- Build your React app
- Deploy to GitHub Pages

### Step 5: Access Your Site

Your frontend will be live at:
```
https://YOUR_USERNAME.github.io/mentormatch/
```

---

## Part 3: Create Admin Account

Once deployed, create a superuser to access the admin panel:

1. In Render dashboard, go to your web service
2. Click **"Shell"** tab
3. Run:
```bash
python manage.py createsuperuser
```

Access admin at: `https://your-app-name.onrender.com/admin/`

---

## Part 4: Verify Everything Works

1. Visit your GitHub Pages URL
2. Try signing up as a new user
3. Log in and test features:
   - Update profile
   - Upload media
   - Swipe on potential matches
   - Send messages

---

## Troubleshooting

### Frontend shows but buttons don't work
- Check the `VITE_API_BASE_URL` secret in GitHub
- Check browser console for CORS errors
- Verify `CORS_ALLOWED_ORIGINS` in Render includes your GitHub Pages URL

### Backend returns 500 errors
- Check Render logs: Dashboard → Your Service → Logs
- Verify all environment variables are set
- Make sure migrations ran: `python manage.py migrate`

### Database errors
- Render should auto-create PostgreSQL database
- Check that `DATABASE_URL` environment variable exists in Render

### Images/media not loading
- For production, you'll want to configure cloud storage (AWS S3, Cloudinary)
- Current setup stores media on Render's ephemeral filesystem (resets on deploy)

---

## Cost Breakdown

**Free Tier Limits:**
- GitHub Pages: Unlimited static hosting
- Render Free Tier:
  - 750 hours/month (plenty for one service)
  - Service spins down after 15 min inactivity
  - 512MB RAM
  - Shared CPU

**To avoid service spin-down** (optional):
- Upgrade to Render paid plan ($7/month)
- Or use a service like UptimeRobot to ping your backend every 10 minutes

---

## Next Steps

### Optional Improvements:

1. **Custom Domain**
   - Add a custom domain in GitHub Pages settings
   - Update `CORS_ALLOWED_ORIGINS` in Render

2. **Environment-Specific Settings**
   - Create separate `.env` files for dev/staging/prod

3. **Cloud Media Storage**
   - Set up AWS S3 or Cloudinary for persistent media storage
   - Update Django settings for cloud storage backend

4. **Monitoring**
   - Add Sentry for error tracking
   - Set up logging in Render

5. **Performance**
   - Enable Render autoscaling
   - Add Redis for caching

---

## Quick Reference Commands

### Local Development
```bash
# Backend
cd mentormatch_backend
python3 manage.py runserver 8000

# Frontend
cd mentormatch_frontend
npm run dev
```

### Production URLs
- Frontend: `https://YOUR_USERNAME.github.io/mentormatch/`
- Backend API: `https://your-app-name.onrender.com/api/`
- Admin Panel: `https://your-app-name.onrender.com/admin/`

---

## Support

If you encounter issues:
1. Check Render logs for backend errors
2. Check browser console for frontend errors
3. Verify all environment variables are set correctly
4. Ensure CORS settings allow your frontend URL

For more help:
- Render Docs: https://render.com/docs
- GitHub Pages Docs: https://docs.github.com/pages
